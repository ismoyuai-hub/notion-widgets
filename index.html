<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notion Optimized Time Widget</title>
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <style>
        :root {
            /* 浅色模式标记 - 基于 Notion 调色盘  */
            --bg: transparent;
            --card-bg: #ffffff;
            --text-main: #373530;
            --text-muted: #787774;
            --bar-bg: #f1f1ef;
            --accent-year: #2eaadc;
            --accent-month: #448361;
            --accent-week: #d9730d;
            --radius: 4px;
            --shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        /* 自动检测并匹配系统深色模式  */
        @media (prefers-color-scheme: dark) {
            :root {
                --card-bg: #191919;
                --text-main: #d4d4d4;
                --text-muted: #9b9b9b;
                --bar-bg: #252525;
                --accent-year: #447acb;
                --accent-month: #4f9768;
                --accent-week: #cb7b37;
                --shadow: 0 1px 3px rgba(0,0,0,0.3);
            }
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: var(--text-main);
            -webkit-font-smoothing: antialiased;
        }

       .widget {
            padding: 24px;
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            width: 85%;
            max-width: 400px;
            transition: all 0.3s ease;
        }

       .header {
            text-align: center;
            margin-bottom: 24px;
        }

        #dateText {
            font-size: 13px;
            color: var(--text-muted);
            margin-bottom: 4px;
            font-weight: 500;
            letter-spacing: 0.02em;
        }

        #timeText {
            font-size: 36px;
            font-weight: 700;
            /* 开启等宽数字，防止秒数跳动偏移 [1] */
            font-variant-numeric: tabular-nums;
            letter-spacing: -0.04em;
        }

       .progress-section {
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

       .row {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

       .row-info {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

       .bar-container {
            height: 10px;
            background: var(--bar-bg);
            border-radius: 5px;
            overflow: hidden;
        }

       .bar-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #yearBar { background: var(--accent-year); }
        #monthBar { background: var(--accent-month); }
        #weekBar { background: var(--accent-week); }

       .footer {
            margin-top: 24px;
            font-size: 11px;
            color: var(--text-muted);
            text-align: center;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="widget">
        <div class="header">
            <div id="dateText">加载中...</div>
            <div id="timeText">00:00:00</div>
        </div>
        
        <div class="progress-section">
            <div class="row">
                <div class="row-info">
                    <span>Year</span>
                    <span id="yearPct">0%</span>
                </div>
                <div class="bar-container">
                    <div id="yearBar" class="bar-fill" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="row">
                <div class="row-info">
                    <span>Month</span>
                    <span id="monthPct">0%</span>
                </div>
                <div class="bar-container">
                    <div id="monthBar" class="bar-fill" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="row">
                <div class="row-info">
                    <span>Week</span>
                    <span id="weekPct">0%</span>
                </div>
                <div class="bar-container">
                    <div id="weekBar" class="bar-fill" style="width: 0%"></div>
                </div>
            </div>
        </div>
        
        <div id="footerText" class="footer">0 / 0 Days Passed</div>
    </div>

    <script>
        function isLeapYear(year) {
            return (year % 4 === 0 && year % 100!== 0) |

| (year % 400 === 0);
        }

        function getDaysInMonth(year, month) {
            return new Date(year, month + 1, 0).getDate();
        }

        function update() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const date = now.getDate();
            // 设定周进度，将周一设为第一天 
            const day = now.getDay() === 0? 7 : now.getDay(); 

            // 时间显示逻辑
            const pad = (n) => n.toString().padStart(2, '0');
            const dayNames = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];
            document.getElementById('dateText').textContent = `${year}年${month + 1}月${date}日 ${dayNames}`;
            document.getElementById('timeText').textContent = `${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;

            // 年进度逻辑 [9, 10]
            const startOfYear = new Date(year, 0, 1);
            const daysPassed = Math.floor((now - startOfYear) / (24 * 60 * 60 * 1000)) + 1;
            const totalDaysInYear = isLeapYear(year)? 366 : 365;
            const yearPct = (daysPassed / totalDaysInYear) * 100;
            document.getElementById('yearBar').style.width = yearPct + '%';
            document.getElementById('yearPct').textContent = Math.round(yearPct) + '%';
            document.getElementById('footerText').textContent = `${daysPassed} / ${totalDaysInYear} Days (Yearly Progress)`;

            // 月进度逻辑 [11]
            const daysInMonth = getDaysInMonth(year, month);
            const monthPct = (date / daysInMonth) * 100;
            document.getElementById('monthBar').style.width = monthPct + '%';
            document.getElementById('monthPct').textContent = Math.round(monthPct) + '%';

            // 周进度逻辑
            const weekPct = (day / 7) * 100;
            document.getElementById('weekBar').style.width = weekPct + '%';
            document.getElementById('weekPct').textContent = Math.round(weekPct) + '%';
        }

        // 启动每秒更新
        setInterval(update, 1000);
        update();
    </script>
</body>
</html>
